PCSDK_dir='C:/Program Files (x86)/Intel/PCSDK/';
include1=[PCSDK_dir 'include'];
include2=[PCSDK_dir 'sample/common/include'];
include3=[PCSDK_dir 'sample/common/res'];

f1=[PCSDK_dir 'src/libpxc/'];
f2=[PCSDK_dir 'sample/common/src/'];

cmpflags='COMPFLAGS=/c /GR /W3 /EHs /D_CRT_SECURE_NO_DEPRECATE /D_SCL_SECURE_NO_DEPRECATE /D_SECURE_SCL=0 /DMATLAB_MEX_FILE /nologo /MD /fp:precise /Zc:wchar_t /Zc:forScope';

cd('Mex');
files=dir('*.cpp');
for i=1:length(files)
    Filename=files(i).name;
    clear(Filename); 

    mex('-v','-largeArrayDims', ...
        '-DWIN64', '-DUNICODE','-D_UNICODE', ...
        ['-I' include1],...
        ['-I' include2],...
        ['-I' include3], ...
        Filename, ...
        [f1 'libpxc.cpp'],...
        [f2 'util_capture.cpp'], ...
        [f2 'util_capture_file.cpp'],...
        [f2 'util_captureimpl.cpp'],...
        [f2 'util_pipeline_face.cpp'], ...
        [f2 'util_pipeline_gesture.cpp'], ...
        [f2 'util_pipeline_voice.cpp'], ...
        [f2 'util_pipeline_segmentation.cpp'], ...
        [f2 'util_pipeline_raw.cpp']);
end
cd('..');
addpath('Mex')